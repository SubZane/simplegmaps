/*! simplegmaps - v2.0 - 2016-01-25
* https://github.com/SubZane/simplegmaps
* Copyright (c) 2016 Andreas Norman; Licensed MIT */
!function(a,b){"function"==typeof define&&define.amd?define([],b(a)):"object"==typeof exports?module.exports=b(a):a.simplegmaps=b(a)}("undefined"!=typeof global?global:this.window||this.global,function(a){"use strict";var b,c,d,e,f,g={},h=!!document.querySelector&&!!a.addEventListener,i={debug:!0,MapOptions:{draggable:!0,zoom:2,center:"55.604981,13.003822",scrollwheel:!1,streetViewControl:!1,panControl:!0,zoomControl:!0,zoomControlOptions:{style:"DEFAULT"}},onInit:function(){},onDestroy:function(){}},j=function(){f=d.cloneNode(!0),e=new google.maps.Map(d,b.MapOptions)},k=function(){var a=f.querySelectorAll(".map-marker");q(a,function(a,b){var c={},f=new google.maps.Marker({title:a.getAttribute("title")});if(a.querySelector(".map-infowindow")){var g=new google.maps.InfoWindow({content:a.querySelector("div.map-infowindow").parentElement.innerHTML});f.addListener("click",function(){g.open(e,f)})}else if(a.querySelector(".map-custom-infowindow")){var h=a.querySelector(".map-custom-infowindow").parentElement.innerHTML;google.maps.event.addListener(f,"click",function(){var a=document.querySelector("#simplegmaps-c-iw");null!==a&&a.parentNode.removeChild(a),d.insertAdjacentHTML("afterend",'<div id="simplegmaps-c-iw"></div>'),document.querySelector("#simplegmaps-c-iw").innerHTML=h,document.querySelector("#simplegmaps-c-iw .close").addEventListener("click",function(a){a.preventDefault();var b=document.querySelector("#simplegmaps-c-iw");null!==b&&b.parentNode.removeChild(b)})})}l(a,function(b){c.position=b;var d=a.getAttribute("data-icon"),g=a.getAttribute("data-icon2x");m(d,g,function(a){c.icon=a,f.setOptions(c),f.setMap(e)})})})},l=function(a,b){if(a.hasAttribute("data-latlng"))b(n(a.getAttribute("data-latlng")));else if(a.hasAttribute("data-address")){var c=new google.maps.Geocoder;c.geocode({address:a.getAttribute("data-address")},function(a,c){c===google.maps.GeocoderStatus.OK&&b(a[0].geometry.location)})}},m=function(a,b,c){var d=new Image;"undefined"==typeof a||null===a?c(null):window.devicePixelRatio>1.5&&("undefined"!=typeof b||null===a)?(d.onload=function(){var a={url:b,size:new google.maps.Size(d.naturalWidth/2,d.naturalHeight/2),scaledSize:new google.maps.Size(d.naturalWidth/2,d.naturalHeight/2),origin:new google.maps.Point(0,0)};c(a)},d.src=b):(d.onload=function(){var b={url:a,size:new google.maps.Size(d.naturalWidth,d.naturalHeight)};c(b)},d.src=a)},n=function(a){var b=a.split(/,\s*/),c=new google.maps.LatLng(parseFloat(b[0]),parseFloat(b[1]));return c},o=function(a){void 0!==b[a]&&b[a].call(d)},p=function(a,b){var c={};return q(a,function(b,d){c[d]=a[d]}),q(b,function(a,d){c[d]=b[d]}),c},q=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,a[d],d,a);else for(var e=0,f=a.length;f>e;e++)b.call(c,a[e],e,a)};return g.destroy=function(){b&&(document.documentElement.classList.remove(b.initClass),document.removeEventListener("click",eventHandler,!1),b=null,c=null,o("onDestroy"))},g.init=function(a){h&&(g.destroy(),b=p(i,a||{}),d=document.querySelector(b.container),b.MapOptions.center&&(b.MapOptions.center=n(b.MapOptions.center)),b.MapOptions.zoom||(b.MapOptions.zoom=4),j(),k(),o("onInit"))},g.publicMethod=function(){},g});